//see the assignment3.2 for details